Added centralized SQL generator to reduce the number of SQL methods needed in future